
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
    <script type="text/javascript">
  var duoshuoQuery = {short_name:"dexsinis"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//dexsinister.github.io/js/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
  
  <title>AFNetworking简单使用 | DexSinis Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="AFNetworking是一个轻量级的iOS网络通信类库。它建立在NSURLConnection和NSOperation等类库的基础上，让很多网络通信功能的实现变得十分简单。它支持HTTP请求和基于REST的网络服务（包括GET、POST、 PUT、DELETE等）。支持ARC。Github地址：https://github.com/AFNetworking/AFNetworking
//
//">
<meta property="og:type" content="article">
<meta property="og:title" content="AFNetworking简单使用">
<meta property="og:url" content="http://yoursite.com/2015/10/09/AFNetworking简单使用/index.html">
<meta property="og:site_name" content="DexSinis Blog">
<meta property="og:description" content="AFNetworking是一个轻量级的iOS网络通信类库。它建立在NSURLConnection和NSOperation等类库的基础上，让很多网络通信功能的实现变得十分简单。它支持HTTP请求和基于REST的网络服务（包括GET、POST、 PUT、DELETE等）。支持ARC。Github地址：https://github.com/AFNetworking/AFNetworking
//
//">
<meta property="og:updated_time" content="2015-10-09T02:37:58.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AFNetworking简单使用">
<meta name="twitter:description" content="AFNetworking是一个轻量级的iOS网络通信类库。它建立在NSURLConnection和NSOperation等类库的基础上，让很多网络通信功能的实现变得十分简单。它支持HTTP请求和基于REST的网络服务（包括GET、POST、 PUT、DELETE等）。支持ARC。Github地址：https://github.com/AFNetworking/AFNetworking
//
//">
  
    <link rel="alternative" href="/atom.xml" title="DexSinis Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-67376920-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->

<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/solarized_dark.min.css">
<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>

<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">DexSinis Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="yoursite.com">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-AFNetworking简单使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/10/09/AFNetworking简单使用/" class="article-date">
  <time datetime="2015-10-09T03:50:07.000Z" itemprop="datePublished">2015-10-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      AFNetworking简单使用
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>AFNetworking是一个轻量级的iOS网络通信类库。它建立在NSURLConnection和NSOperation等类库的基础上，让很多网络通信功能的实现变得十分简单。它支持HTTP请求和基于REST的网络服务（包括GET、POST、 PUT、DELETE等）。支持ARC。<br>Github地址：<a href="https://github.com/AFNetworking/AFNetworking" target="_blank" rel="external">https://github.com/AFNetworking/AFNetworking</a></strong></p>
<pre><code><span class="comment">//</span>
<span class="comment">//  MJViewController.m</span>
<span class="comment">//  03.AFN演练</span>
<span class="comment">//</span>
<span class="comment">//  Created by apple on 14-4-30.</span>
<span class="comment">//  Copyright (c) 2014年 itcast. All rights reserved.</span>
<span class="comment">//</span>

<span class="preprocessor">#import <span class="title">"MJViewController.h"</span></span>
<span class="preprocessor">#import <span class="title">"AFNetworking.h"</span></span>
<span class="class"><span class="keyword">@interface</span> <span class="title">MJViewController</span> ()</span>
<span class="keyword">@end</span>

<span class="class"><span class="keyword">@implementation</span> <span class="title">MJViewController</span></span>
<span class="comment">/**
要使用常规的AFN网络访问

 1. AFHTTPRequestOperationManager *manager =             [AFHTTPRequestOperationManager manager];

所有的网络请求,均有manager发起

 2. 需要注意的是,默认提交请求的数据是二进制的,返回格式是JSON

1&gt; 如果提交数据是JSON的,需要将请求格式设置为AFJSONRequestSerializer
2&gt; 如果返回格式不是JSON的,

 3. 请求格式

 AFHTTPRequestSerializer            二进制格式
 AFJSONRequestSerializer            JSON
 AFPropertyListRequestSerializer    PList(是一种特殊的XML,解析起来相对容易)

 4. 返回格式

 AFHTTPResponseSerializer           二进制格式
 AFJSONResponseSerializer           JSON
 AFXMLParserResponseSerializer          XML,只能返回XMLParser,还需要自己通过代理方法解析
 AFXMLDocumentResponseSerializer (Mac OS X)
 AFPropertyListResponseSerializer   PList
 AFImageResponseSerializer          Image
 AFCompoundResponseSerializer       组合
 */</span>

- (<span class="keyword">void</span>)viewDidLoad
{
[<span class="keyword">super</span> viewDidLoad];

[<span class="keyword">self</span> reach];
}

<span class="preprocessor">#pragma mark - 演练</span>
<span class="preprocessor">#pragma mark - 检测网络连接</span>
- (<span class="keyword">void</span>)reach
{
    <span class="comment">/**
 AFNetworkReachabilityStatusUnknown          = -1,  // 未知
 AFNetworkReachabilityStatusNotReachable     = 0,   // 无连接
 AFNetworkReachabilityStatusReachableViaWWAN = 1,   // 3G 花钱
 AFNetworkReachabilityStatusReachableViaWiFi = 2,   // 局域网络,不花钱
 */</span>
<span class="comment">// 如果要检测网络状态的变化,必须用检测管理器的单例的startMonitoring</span>
[[AFNetworkReachabilityManager sharedManager] startMonitoring];

<span class="comment">// 检测网络连接的单例,网络变化时的回调方法</span>
[[AFNetworkReachabilityManager sharedManager]     setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status) {
    <span class="built_in">NSLog</span>(<span class="string">@"%d"</span>, status);
}];
}

<span class="preprocessor">#pragma mark - Session 下载</span>
- (<span class="keyword">void</span>)sessionDownload
{
<span class="built_in">NSURLSessionConfiguration</span> *config = [<span class="built_in">NSURLSessionConfiguration</span> defaultSessionConfiguration];
AFURLSessionManager *manager = [[AFURLSessionManager alloc] initWithSessionConfiguration:config];

<span class="built_in">NSString</span> *urlString = <span class="string">@"http://localhost/itcast/videos/01.C语言-语法预览.mp4"</span>;
urlString = [urlString stringByAddingPercentEscapesUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];

<span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:urlString];
<span class="built_in">NSURLRequest</span> *request = [<span class="built_in">NSURLRequest</span> requestWithURL:url];

<span class="built_in">NSURLSessionDownloadTask</span> *task = [manager downloadTaskWithRequest:request progress:<span class="literal">nil</span> destination:^<span class="built_in">NSURL</span> *(<span class="built_in">NSURL</span> *targetPath, <span class="built_in">NSURLResponse</span> *response) {
    <span class="comment">// 指定下载文件保存的路径</span>
<span class="comment">//        NSLog(@"%@ %@", targetPath, response.suggestedFilename);</span>
    <span class="comment">// 将下载文件保存在缓存路径中</span>
    <span class="built_in">NSString</span> *cacheDir = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSCachesDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>)[<span class="number">0</span>];
    <span class="built_in">NSString</span> *path = [cacheDir stringByAppendingPathComponent:response<span class="variable">.suggestedFilename</span>];

    <span class="comment">// URLWithString返回的是网络的URL,如果使用本地URL,需要注意</span>
    <span class="built_in">NSURL</span> *fileURL1 = [<span class="built_in">NSURL</span> URLWithString:path];
    <span class="built_in">NSURL</span> *fileURL = [<span class="built_in">NSURL</span> fileURLWithPath:path];

    <span class="built_in">NSLog</span>(<span class="string">@"== %@ |||| %@"</span>, fileURL1, fileURL);

    <span class="keyword">return</span> fileURL;
} completionHandler:^(<span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSURL</span> *filePath, <span class="built_in">NSError</span> *error) {
    <span class="built_in">NSLog</span>(<span class="string">@"%@ %@"</span>, filePath, error);
}];

[task resume];
}

<span class="preprocessor">#pragma mark - POST JSON</span>
- (<span class="keyword">void</span>)postJSON
{
AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];

<span class="built_in">NSDictionary</span> *dict = @{<span class="string">@"name"</span>: <span class="string">@"zhangsan"</span>};
<span class="built_in">NSDictionary</span> *dict1 = @{<span class="string">@"name"</span>: <span class="string">@"wangwu"</span>};
<span class="built_in">NSArray</span> *array = @[dict, dict1];
<span class="comment">// 设置请求格式</span>
manager<span class="variable">.requestSerializer</span> = [AFJSONRequestSerializer serializer];
<span class="comment">// 设置返回格式</span>
manager<span class="variable">.responseSerializer</span> = [AFHTTPResponseSerializer serializer];

[manager POST:<span class="string">@"http://localhost/postjson.php"</span> parameters:array success:^(AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {
    <span class="built_in">NSString</span> *result = [[<span class="built_in">NSString</span> alloc] initWithData:responseObject encoding:<span class="built_in">NSUTF8StringEncoding</span>];

    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, result);
} failure:^(AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {

}];

}

<span class="preprocessor">#pragma mark - 随机文件名上传</span>
- (<span class="keyword">void</span>)postUpload1
{
<span class="comment">// 本地上传给服务器时,没有确定的URL,不好用MD5的方式处理</span>
AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];
manager<span class="variable">.responseSerializer</span> = [AFHTTPResponseSerializer serializer];

[manager POST:<span class="string">@"http://localhost/demo/upload.php"</span> parameters:<span class="literal">nil</span> constructingBodyWithBlock:^(<span class="keyword">id</span>&lt;AFMultipartFormData&gt; formData) {

    <span class="built_in">NSURL</span> *fileURL = [[<span class="built_in">NSBundle</span> mainBundle] URLForResource:<span class="string">@"头像1.png"</span> withExtension:<span class="literal">nil</span>];

    <span class="comment">// 要上传保存在服务器中的名称</span>
    <span class="comment">// 使用时间来作为文件名 2014-04-30 14:20:57.png</span>
    <span class="comment">// 让不同的用户信息,保存在不同目录中</span>
    <span class="built_in">NSDateFormatter</span> *formatter = [[<span class="built_in">NSDateFormatter</span> alloc] init];
    <span class="comment">// 设置日期格式</span>
    formatter<span class="variable">.dateFormat</span> = <span class="string">@"yyyy-MM-dd HH:mm:ss"</span>;
    <span class="built_in">NSString</span> *fileName = [formatter stringFromDate:[<span class="built_in">NSDate</span> date]];

    [formData appendPartWithFileURL:fileURL name:<span class="string">@"uploadFile"</span> fileName:fileName mimeType:<span class="string">@"image/png"</span> error:<span class="literal">NULL</span>];

} success:^(AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {
    <span class="built_in">NSLog</span>(<span class="string">@"OK"</span>);
} failure:^(AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {
    <span class="built_in">NSLog</span>(<span class="string">@"error"</span>);
}];
}

<span class="preprocessor">#pragma mark - POST上传</span>
- (<span class="keyword">void</span>)postUpload
{
AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];
<span class="comment">// AFHTTPResponseSerializer就是正常的HTTP请求响应结果:NSData</span>
<span class="comment">// 当请求的返回数据不是JSON,XML,PList,UIImage之外,使用AFHTTPResponseSerializer</span>
<span class="comment">// 例如返回一个html,text...</span>
<span class="comment">//</span>
<span class="comment">// 实际上就是AFN没有对响应数据做任何处理的情况</span>
manager<span class="variable">.responseSerializer</span> = [AFHTTPResponseSerializer serializer];

<span class="comment">// formData是遵守了AFMultipartFormData的对象</span>
[manager POST:<span class="string">@"http://localhost/demo/upload.php"</span> parameters:<span class="literal">nil</span> constructingBodyWithBlock:^(<span class="keyword">id</span>&lt;AFMultipartFormData&gt; formData) {

    <span class="comment">// 将本地的文件上传至服务器</span>
    <span class="built_in">NSURL</span> *fileURL = [[<span class="built_in">NSBundle</span> mainBundle] URLForResource:<span class="string">@"头像1.png"</span> withExtension:<span class="literal">nil</span>];

    [formData appendPartWithFileURL:fileURL name:<span class="string">@"uploadFile"</span> error:<span class="literal">NULL</span>];
} success:^(AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {
    <span class="built_in">NSString</span> *result = [[<span class="built_in">NSString</span> alloc] initWithData:responseObject encoding:<span class="built_in">NSUTF8StringEncoding</span>];

    <span class="built_in">NSLog</span>(<span class="string">@"完成 %@"</span>, result);
} failure:^(AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {
    <span class="built_in">NSLog</span>(<span class="string">@"错误 %@"</span>, error<span class="variable">.localizedDescription</span>);
}];
}

<span class="preprocessor">#pragma mark - JSON</span>
- (<span class="keyword">void</span>)XMLData
{
AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];

<span class="comment">// 返回的数据格式是XML</span>
manager<span class="variable">.responseSerializer</span> = [AFXMLParserResponseSerializer serializer];

<span class="built_in">NSDictionary</span> *dict = @{<span class="string">@"format"</span>: <span class="string">@"xml"</span>};

<span class="comment">// 网络访问是异步的,回调是主线程的,因此程序员不用管在主线程更新UI的事情</span>
[manager GET:<span class="string">@"http://localhost/videos.php"</span> parameters:dict success:^(AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {

    <span class="comment">// 如果结果是XML,同样需要使用6个代理方法解析,或者使用第三方库</span>
    <span class="comment">// 第三方库第三方框架,效率低,内存泄漏</span>
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, responseObject);
} failure:^(AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, error);
}];
}

<span class="preprocessor">#pragma mark - JSON</span>
- (<span class="keyword">void</span>)JSONData
{
AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];

<span class="comment">// 原本需要拼接get访问URL ? &amp; =</span>
<span class="built_in">NSDictionary</span> *dict = @{<span class="string">@"format"</span>: <span class="string">@"json"</span>};

<span class="comment">// 网络访问是异步的,回调是主线程的,因此程序员不用管在主线程更新UI的事情</span>
[manager GET:<span class="string">@"http://localhost/videos.php"</span> parameters:dict success:^(AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, responseObject);
    <span class="comment">// 提问:NSURLConnection异步方法回调,是在子线程</span>
    <span class="comment">// 得到回调之后,通常更新UI,是在主线程</span>
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [<span class="built_in">NSThread</span> currentThread]);
} failure:^(AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, error);
}];
}

<span class="preprocessor">#pragma mark - POST登录</span>
- (<span class="keyword">void</span>)postLogin
{
AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];

<span class="comment">// 原本需要拼接get访问URL ? &amp; =</span>
<span class="built_in">NSDictionary</span> *dict = @{<span class="string">@"username"</span>: <span class="string">@"wangwu"</span>, <span class="string">@"password"</span> : <span class="string">@"wang"</span>};

<span class="comment">// 网络访问是异步的,回调是主线程的,因此程序员不用管在主线程更新UI的事情</span>
[manager POST:<span class="string">@"http://localhost/login.php"</span> parameters:dict success:^(AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, responseObject);
    <span class="comment">// 提问:NSURLConnection异步方法回调,是在子线程</span>
    <span class="comment">// 得到回调之后,通常更新UI,是在主线程</span>
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [<span class="built_in">NSThread</span> currentThread]);
} failure:^(AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, error);
}];
}

<span class="preprocessor">#pragma mark - GET登录</span>
- (<span class="keyword">void</span>)getLogin
{
AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];

<span class="comment">// 原本需要拼接get访问URL ? &amp; =</span>
<span class="built_in">NSDictionary</span> *dict = @{<span class="string">@"username"</span>: <span class="string">@"wangwu"</span>, <span class="string">@"password"</span> : <span class="string">@"wang"</span>};

<span class="comment">// 网络访问是异步的,回调是主线程的,因此程序员不用管在主线程更新UI的事情</span>
[manager GET:<span class="string">@"http://localhost/login.php"</span> parameters:dict success:^(AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, responseObject);
    <span class="comment">// 提问:NSURLConnection异步方法回调,是在子线程</span>
    <span class="comment">// 得到回调之后,通常更新UI,是在主线程</span>
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [<span class="built_in">NSThread</span> currentThread]);
} failure:^(AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {
    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, error);
}];
}

<span class="keyword">@end</span>





－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
    镔哥哥做项目，一般的数据请求不管他多复杂，只要自己写好了请求，那么调用永远是那么的简单，那么我介绍一下

一：需要用到第三方框架AFNetworking，直接写在工程pch头文件里就行因为经常用到它，这在网上随便下载就行，最好用cocopod来下载，这样什么都有了，cocopod是什么，我就不说，博客上面有介绍。

开始啦：

<span class="number">1</span>：自定义网络请求 DataRequestManager类专门管理网络用的

朋友们以下代码就可以直接复制来用了

<span class="variable">.h</span>文件

<span class="comment">//  DataRequestManager.h</span>

<span class="comment">//  TestKeyBoard</span>

<span class="comment">//  Created by mac on 14-10-21.</span>

<span class="comment">//  Copyright (c) 2014 年 mac. All rights reserved.</span>

<span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span>

<span class="class"><span class="keyword">@protocol</span> <span class="title">DataRequestManagerDelegate</span>&lt; <span class="title">NSObject</span> &gt;</span>

<span class="comment">// 通过代理传值到需要的地方</span>

- ( <span class="keyword">void</span> )passValue:( <span class="keyword">id</span> )value;

<span class="keyword">@optional</span>

- ( <span class="keyword">void</span> )passGetValue:( <span class="keyword">id</span> )getValue;

<span class="keyword">@end</span>

<span class="class"><span class="keyword">@interface</span> <span class="title">DataRequestManager</span> : <span class="title">NSObject</span></span>

{

AFHTTPRequestOperationManager *manager; <span class="comment">// 创建请求（ iOS 6-7 ）</span>

AFURLSessionManager *sessionManager;    <span class="comment">// 创建请求（ iOS7 专用）</span>

AFHTTPRequestOperation *operation;      <span class="comment">// 创建请求管理（用于上传和下载）</span>

}

<span class="keyword">@property</span> ( <span class="keyword">nonatomic</span> , <span class="keyword">assign</span> ) <span class="keyword">id</span> &lt; DataRequestManagerDelegate &gt; delegate;

<span class="comment">//GET 请求调用方法</span>

- ( <span class="keyword">void</span> )methodGetWithURL:( <span class="built_in">NSString</span> *)urlString;

<span class="comment">//POST 请求调用方法</span>

- ( <span class="keyword">void</span> )methodPostWithURL:( <span class="built_in">NSString</span> *)urlString parameters:( <span class="built_in">NSDictionary</span> *)parameters;

<span class="comment">// 上传图片</span>

- ( <span class="keyword">void</span> )methodUploadWithURL:( <span class="built_in">NSString</span> *)urlString parameters:( <span class="built_in">NSDictionary</span> *)parameters image:( <span class="built_in">UIImage</span> *)image;

<span class="keyword">@end</span>

<span class="variable">.m</span>文件

<span class="comment">//  DataRequestManager.m</span>

<span class="comment">//  TestKeyBoard</span>

<span class="comment">//</span>

<span class="comment">//  Created by mac on 14-10-21.</span>

<span class="comment">//  Copyright (c) 2014 年 mac. All rights reserved.</span>

<span class="comment">//</span>

<span class="preprocessor">#import <span class="title">"DataRequestManager.h"</span></span>

<span class="preprocessor">#import <span class="title">"AFNetworking.h"</span></span>

<span class="class"><span class="keyword">@implementation</span> <span class="title">DataRequestManager</span></span>

<span class="comment">//GET 请求</span>

- ( <span class="keyword">void</span> )methodGetWithURL:( <span class="built_in">NSString</span> *)urlString

{

<span class="comment">// 致空请求</span>

<span class="keyword">if</span> ( manager ) {

manager = <span class="literal">nil</span> ;

}

<span class="comment">// 创建请求</span>

manager = [ AFHTTPRequestOperationManager manager ];

<span class="comment">// 设置请求的解析器为 AFHTTPResponseSerializer （用于直接解析数据 NSData ），默认为 AFJSONResponseSerializer （用于解析 JSON ）</span>

<span class="comment">//    manager.responseSerializer = [AFHTTPResponseSerializer serializer];</span>

<span class="comment">// 发送 GET 请求</span>

[ manager GET :urlString parameters : <span class="literal">nil</span> success :^( AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {

<span class="comment">// 请求成功（当解析器为 AFJSONResponseSerializer 时）</span>

<span class="built_in">NSLog</span> ( <span class="string">@"getSuccess: %@"</span> , responseObject);

[ <span class="keyword">self</span> . delegate passGetValue :responseObject];

<span class="comment">// 请求成功（当解析器为 AFHTTPResponseSerializer 时）</span>

<span class="comment">//        NSString *JSONString = [[NSString alloc] initWithData:responseObject encoding:NSUTF8StringEncoding];</span>

<span class="comment">//        NSLog(@"success:%@", JSONString);</span>

} failure :^( AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {

<span class="comment">// 请求失败</span>

<span class="built_in">NSLog</span> ( <span class="string">@"Error: %@"</span> , error);

}];

}

<span class="preprocessor">#pragma mark - POST Request (iOS 6-7)</span>

<span class="comment">//POST 请求</span>

- ( <span class="keyword">void</span> )methodPostWithURL:( <span class="built_in">NSString</span> *)urlString parameters:( <span class="built_in">NSDictionary</span> *)parameters

{

<span class="comment">// 致空请求</span>

<span class="keyword">if</span> ( manager ) {

manager = <span class="literal">nil</span> ;

}

<span class="comment">// 添加参数</span>

<span class="comment">// 创建请求</span>

manager = [ AFHTTPRequestOperationManager manager ];

<span class="comment">// 设置请求的解析器为 AFHTTPResponseSerializer （用于直接解析数据 NSData ），默认为 AFJSONResponseSerializer （用于解析 JSON ）</span>

<span class="comment">//    manager.responseSerializer = [AFHTTPResponseSerializer serializer];</span>

<span class="comment">// 发送 POST 请求</span>

[ manager POST :urlString parameters :parameters success :^( AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {

<span class="comment">// 请求成功（当解析器为 AFJSONResponseSerializer 时）</span>

<span class="comment">//        NSLog(@"Success: %@", responseObject);</span>

[ <span class="keyword">self</span> . delegate passValue :responseObject];

<span class="comment">// 请求成功（当解析器为 AFHTTPResponseSerializer 时）</span>

<span class="comment">//        NSString *JSONString = [[NSString alloc] initWithData:responseObject encoding:NSUTF8StringEncoding];</span>

<span class="comment">//        NSLog(@"success:%@", JSONString);</span>

} failure :^( AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {

<span class="comment">// 请求失败</span>

<span class="built_in">NSLog</span> ( <span class="string">@"Error: %@"</span> , error);

}];

}

<span class="preprocessor">#pragma mark - Upload Request (iOS 6-7)</span>

<span class="comment">// 上传（以表单方式上传，以图片为例）</span>

- ( <span class="keyword">void</span> )methodUploadWithURL:( <span class="built_in">NSString</span> *)urlString parameters:( <span class="built_in">NSDictionary</span> *)parameters image:( <span class="built_in">UIImage</span> *)image

{

<span class="comment">// 致空请求</span>

<span class="keyword">if</span> ( manager ) {

manager = <span class="literal">nil</span> ;

}

<span class="comment">// 添加参数</span>

<span class="comment">// 创建请求</span>

manager = [ AFHTTPRequestOperationManager manager ];

<span class="comment">// 设置请求的解析器为 AFHTTPResponseSerializer （用于直接解析数据 NSData ），默认为 AFJSONResponseSerializer （用于解析 JSON ）</span>

<span class="comment">//    manager.responseSerializer = [AFHTTPResponseSerializer serializer];</span>

<span class="comment">// 发送 POST 请求，添加需要发送的文件，此处为图片</span>

[ manager POST :urlString parameters :parameters constructingBodyWithBlock :^( <span class="keyword">id</span> &lt; AFMultipartFormData &gt; formData) {

<span class="comment">// 添加图片，并对其进行压缩（ 0.0 为最大压缩率， 1.0 为最小压缩率）</span>

<span class="built_in">NSData</span> *imageData = <span class="built_in">UIImageJPEGRepresentation</span> (image, <span class="number">1.0</span> );

<span class="built_in">NSDateFormatter</span> *formatter = [[ <span class="built_in">NSDateFormatter</span> alloc ] init ];

<span class="comment">// 设置时间格式</span>

formatter. dateFormat = <span class="string">@"yyyyMMddHHmmss"</span> ;

<span class="built_in">NSString</span> *str = [formatter stringFromDate :[ <span class="built_in">NSDate</span> date ]];

<span class="built_in">NSString</span> *fileName = [ <span class="built_in">NSString</span> stringWithFormat : <span class="string">@"%@.png"</span> , str];

<span class="comment">// 添加要上传的文件，此处为图片</span>

[formData appendPartWithFileData :imageData

name : <span class="string">@"uploadFile"</span>

fileName :fileName

mimeType : <span class="string">@"image/jpeg"</span> ];

} success :^( AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) {

<span class="comment">// 请求成功（当解析器为 AFJSONResponseSerializer 时）</span>

<span class="built_in">NSLog</span> ( <span class="string">@"Success: %@"</span> , responseObject);

[ <span class="keyword">self</span> . delegate passValue :responseObject];

<span class="comment">// 请求成功（当解析器为 AFHTTPResponseSerializer 时）</span>

<span class="comment">//        NSString *JSONString = [[NSString alloc] initWithData:responseObject encoding:NSUTF8StringEncoding];</span>

<span class="comment">//        NSLog(@"success:%@", JSONString);</span>

} failure :^( AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) {

<span class="comment">// 请求失败</span>

<span class="built_in">NSLog</span> ( <span class="string">@"Error: %@"</span> , error);

}];

}

<span class="preprocessor">#pragma mark - Download Request (iOS 6-7)</span>

<span class="comment">// 下载</span>

- ( <span class="keyword">void</span> )methodDownload

{

<span class="comment">/*

// 下载进度条

UIProgressView  *downProgressView = [[UIProgressView alloc] initWithProgressViewStyle:UIProgressViewStyleDefault];

downProgressView.center = CGPointMake(self.view.center.x, 220);

downProgressView.progress = 0;

downProgressView.progressTintColor = [UIColor blueColor];

downProgressView.trackTintColor = [UIColor grayColor];

[self.view addSubview:downProgressView];

// 设置存放文件的位置（此 Demo 把文件保存在 iPhone 沙盒中的 Documents 文件夹中。关于如何获取文件路径，请自行搜索相关资料）

// 方法一

//    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

//    NSString *cachesDirectory = [paths objectAtIndex:0];

//    NSString *filePath = [cachesDirectory stringByAppendingPathComponent:@" 文件名 "];

// 方法二

NSString *filePath = [NSString stringWithFormat:@"%@/Documents/ 文件名（注意后缀名） ", NSHomeDirectory()];

// 打印文件保存的路径

NSLog(@"%@",filePath);

// 创建请求管理

operation = [[AFHTTPRequestOperation alloc] initWithRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@" 下载地址 "]]];

// 添加下载请求（获取服务器的输出流）

operation.outputStream = [NSOutputStream outputStreamToFileAtPath:filePath append:NO];

// 设置下载进度条

[operation setDownloadProgressBlock:^(NSUInteger bytesRead, long long totalBytesRead, long long totalBytesExpectedToRead) {

// 显示下载进度

CGFloat progress = ((float)totalBytesRead) / totalBytesExpectedToRead;

[downProgressView setProgress:progress animated:YES];

}];

// 请求管理判断请求结果

[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {

// 请求成功

NSLog(@"Finish and Download to: %@", filePath);

} failure:^(AFHTTPRequestOperation *operation, NSError *error) {

// 请求失败

NSLog(@"Error: %@",error);

}];

*/</span>

}

<span class="preprocessor">#pragma mark - Download Management (iOS 6-7)</span>

<span class="comment">// 开始下载（断点续传）</span>

- ( <span class="keyword">void</span> )downloadStart

{

[ <span class="keyword">self</span> methodDownload ];

[ operation start ];

}

<span class="comment">// 暂停下载（断点续传）</span>

- ( <span class="keyword">void</span> )downloadPause

{

[ operation pause ];

}

<span class="comment">// 继续下载（断点续传）</span>

- ( <span class="keyword">void</span> )downloadResume

{

[ operation resume ];

}

<span class="preprocessor">#pragma mark - Upload Request (iOS 7 only)</span>

<span class="comment">// 上传（ iOS7 专用）</span>

- ( <span class="keyword">void</span> )methodUploadFor7

{

<span class="comment">// 致空请求</span>

<span class="keyword">if</span> ( sessionManager ) {

sessionManager = <span class="literal">nil</span> ;

}

<span class="comment">// 创建请求（ iOS7 专用）</span>

sessionManager = [[ AFURLSessionManager alloc ] initWithSessionConfiguration :[ <span class="built_in">NSURLSessionConfiguration</span> defaultSessionConfiguration ]];

<span class="comment">// 添加请求接口</span>

<span class="built_in">NSURLRequest</span> *request = [ <span class="built_in">NSURLRequest</span> requestWithURL :[ <span class="built_in">NSURL</span> URLWithString : <span class="string">@" 上传地址 "</span> ]];

<span class="comment">// 添加上传的文件</span>

<span class="built_in">NSURL</span> *filePath = [ <span class="built_in">NSURL</span> fileURLWithPath : <span class="string">@" 本地文件地址 "</span> ];

<span class="comment">// 发送上传请求</span>

<span class="built_in">NSURLSessionUploadTask</span> *uploadTask = [ sessionManager uploadTaskWithRequest :request fromFile :filePath progress : <span class="literal">nil</span> completionHandler :^( <span class="built_in">NSURLResponse</span> *response, <span class="keyword">id</span> responseObject, <span class="built_in">NSError</span> *error) {

<span class="keyword">if</span> (error) {

<span class="comment">// 请求失败</span>

<span class="built_in">NSLog</span> ( <span class="string">@"Error: %@"</span> , error);

} <span class="keyword">else</span> {

<span class="comment">// 请求成功</span>

<span class="built_in">NSLog</span> ( <span class="string">@"Success: %@ %@"</span> , response, responseObject);

}

}];

<span class="comment">// 开始上传</span>

[uploadTask resume ];

}

<span class="preprocessor">#pragma mark - Download Request (iOS 7 only)</span>

<span class="comment">// 下载（ iOS7 专用）</span>

- ( <span class="keyword">void</span> )methodDownloadFor7

{

<span class="comment">// 致空请求</span>

<span class="keyword">if</span> ( sessionManager ) {

sessionManager = <span class="literal">nil</span> ;

}

<span class="comment">// 创建请求（ iOS7 专用）</span>

sessionManager = [[ AFURLSessionManager alloc ] initWithSessionConfiguration :[ <span class="built_in">NSURLSessionConfiguration</span> defaultSessionConfiguration ]];

<span class="comment">// 添加请求接口</span>

<span class="built_in">NSURLRequest</span> *request = [ <span class="built_in">NSURLRequest</span> requestWithURL :[ <span class="built_in">NSURL</span> URLWithString : <span class="string">@" 下载地址 "</span> ]];

<span class="comment">// 发送下载请求</span>

<span class="built_in">NSURLSessionDownloadTask</span> *downloadTask = [ sessionManager downloadTaskWithRequest :request progress : <span class="literal">nil</span> destination :^ <span class="built_in">NSURL</span> *( <span class="built_in">NSURL</span> *targetPath, <span class="built_in">NSURLResponse</span> *response) {

<span class="comment">// 设置存放文件的位置（此 Demo 把文件保存在 iPhone 沙盒中的 Documents 文件夹中。关于如何获取文件路径，请自行搜索相关资料）</span>

<span class="built_in">NSURL</span> *filePath = [ <span class="built_in">NSURL</span> fileURLWithPath :[ <span class="built_in">NSSearchPathForDirectoriesInDomains</span> ( <span class="built_in">NSDocumentDirectory</span> , <span class="built_in">NSUserDomainMask</span> , <span class="literal">YES</span> ) firstObject ]];

<span class="keyword">return</span> [filePath URLByAppendingPathComponent :[response suggestedFilename ]];

} completionHandler :^( <span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSURL</span> *filePath, <span class="built_in">NSError</span> *error) {

<span class="comment">// 下载完成</span>

<span class="built_in">NSLog</span> ( <span class="string">@"Finish and Download to: %@"</span> , filePath);

}];

<span class="comment">// 开始下载</span>

[downloadTask resume ];

}

<span class="keyword">@end</span>

工程完美，自己复制可用
</code></pre>
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yoursite.com/2015/10/09/AFNetworking简单使用/" data-id="cij5xh6o7002yi33m43ar5p12" class="article-share-link" data-share="baidu" data-title="AFNetworking简单使用">分享到</a>
      

      
        <a href="http://yoursite.com/2015/10/09/AFNetworking简单使用/#ds-thread" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IOS开发SDK/">IOS开发SDK</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/10/15/ReactNative简单使用/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">
        
          ReactNative简单使用
        
      </div>
    </a>
  
  
    <a href="/2015/10/06/常用命令总结/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">常用命令总结</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <div id="ds-thread" class="ds-thread" data-thread-key="2015/10/09/AFNetworking简单使用/" data-title="AFNetworking简单使用" data-url="http://yoursite.com/2015/10/09/AFNetworking简单使用/"></div>
  </section>
</section>
      
      <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GitHub/">GitHub</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOS-Swift/">IOS-Swift</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOS开发SDK/">IOS开发SDK</a><span class="tag-list-count">21</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOS开发经验总结/">IOS开发经验总结</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOS开源项目/">IOS开源项目</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOS网站博客/">IOS网站博客</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MarkDown/">MarkDown</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node/">Node</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios开发/">ios开发</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios经验/">ios经验</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swift/">swift</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/命令行/">命令行</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/心情/">心情</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/项目/">项目</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Git/" style="font-size: 13.33px;">Git</a> <a href="/tags/GitHub/" style="font-size: 10px;">GitHub</a> <a href="/tags/IOS-Swift/" style="font-size: 10px;">IOS-Swift</a> <a href="/tags/IOS开发SDK/" style="font-size: 20px;">IOS开发SDK</a> <a href="/tags/IOS开发经验总结/" style="font-size: 16.67px;">IOS开发经验总结</a> <a href="/tags/IOS开源项目/" style="font-size: 10px;">IOS开源项目</a> <a href="/tags/IOS网站博客/" style="font-size: 10px;">IOS网站博客</a> <a href="/tags/MarkDown/" style="font-size: 16.67px;">MarkDown</a> <a href="/tags/Node/" style="font-size: 16.67px;">Node</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/ios开发/" style="font-size: 10px;">ios开发</a> <a href="/tags/ios经验/" style="font-size: 10px;">ios经验</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/swift/" style="font-size: 10px;">swift</a> <a href="/tags/命令行/" style="font-size: 10px;">命令行</a> <a href="/tags/心情/" style="font-size: 10px;">心情</a> <a href="/tags/架构/" style="font-size: 10px;">架构</a> <a href="/tags/项目/" style="font-size: 10px;">项目</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">16</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/01/07/textsadasd/">text</a>
          </li>
        
          <li>
            <a href="/2015/12/10/教你如何获取ios系统信息/">教你如何获取ios系统信息</a>
          </li>
        
          <li>
            <a href="/2015/12/07/Git的简单使用/">Git的简单使用</a>
          </li>
        
          <li>
            <a href="/2015/12/05/MVC，MVP 和 MVVM 架构/">MVC，MVP 和 MVVM 架构</a>
          </li>
        
          <li>
            <a href="/2015/11/30/UIViewController简单使用/">UIViewController简单使用</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://xiguabaobao.com" target="_blank">主题作者</a>
          </li>
        
          <li>
            <a href="http://reqianduan.com" target="_blank">热前端</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 DexSinister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<!-- 多说公共js代码 start -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"dexsinis"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共js代码 end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js" type="text/javascript"></script>

</div>
</body>
</html>
